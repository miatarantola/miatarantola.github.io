<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>My Awesome CSCI 0451 Blog â€“ data-cleaning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      color: white;
background: img/landscape.png;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Awesome CSCI 0451 Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<section id="playing-with-data" class="level1">
<h1>Playing with Data</h1>
<section id="importing-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-packages">Importing packages</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># linear algebra</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># data processing, CSV file I/O (e.g. pd.read_csv)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>EPA <span class="op">=</span> pd.read_csv(<span class="st">"pollution_us_2000_2016.csv"</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>EPA.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>Site Num</th>
      <th>Address</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Units</th>
      <th>NO2 Mean</th>
      <th>...</th>
      <th>SO2 Units</th>
      <th>SO2 Mean</th>
      <th>SO2 1st Max Value</th>
      <th>SO2 1st Max Hour</th>
      <th>SO2 AQI</th>
      <th>CO Units</th>
      <th>CO Mean</th>
      <th>CO 1st Max Value</th>
      <th>CO 1st Max Hour</th>
      <th>CO AQI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>13</td>
      <td>3002</td>
      <td>1645 E ROOSEVELT ST-CENTRAL PHOENIX STN</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>Parts per billion</td>
      <td>19.041667</td>
      <td>...</td>
      <td>Parts per billion</td>
      <td>3.000000</td>
      <td>9.0</td>
      <td>21</td>
      <td>13.0</td>
      <td>Parts per million</td>
      <td>1.145833</td>
      <td>4.2</td>
      <td>21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>13</td>
      <td>3002</td>
      <td>1645 E ROOSEVELT ST-CENTRAL PHOENIX STN</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>Parts per billion</td>
      <td>19.041667</td>
      <td>...</td>
      <td>Parts per billion</td>
      <td>3.000000</td>
      <td>9.0</td>
      <td>21</td>
      <td>13.0</td>
      <td>Parts per million</td>
      <td>0.878947</td>
      <td>2.2</td>
      <td>23</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>13</td>
      <td>3002</td>
      <td>1645 E ROOSEVELT ST-CENTRAL PHOENIX STN</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>Parts per billion</td>
      <td>19.041667</td>
      <td>...</td>
      <td>Parts per billion</td>
      <td>2.975000</td>
      <td>6.6</td>
      <td>23</td>
      <td>NaN</td>
      <td>Parts per million</td>
      <td>1.145833</td>
      <td>4.2</td>
      <td>21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>13</td>
      <td>3002</td>
      <td>1645 E ROOSEVELT ST-CENTRAL PHOENIX STN</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>Parts per billion</td>
      <td>19.041667</td>
      <td>...</td>
      <td>Parts per billion</td>
      <td>2.975000</td>
      <td>6.6</td>
      <td>23</td>
      <td>NaN</td>
      <td>Parts per million</td>
      <td>0.878947</td>
      <td>2.2</td>
      <td>23</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>13</td>
      <td>3002</td>
      <td>1645 E ROOSEVELT ST-CENTRAL PHOENIX STN</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-02</td>
      <td>Parts per billion</td>
      <td>22.958333</td>
      <td>...</td>
      <td>Parts per billion</td>
      <td>1.958333</td>
      <td>3.0</td>
      <td>22</td>
      <td>4.0</td>
      <td>Parts per million</td>
      <td>0.850000</td>
      <td>1.6</td>
      <td>23</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 28 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>EPA.drop(labels <span class="op">=</span> [<span class="st">"NO2 Units"</span>, <span class="st">"O3 Units"</span>,<span class="st">"SO2 Units"</span>, <span class="st">"CO Units"</span>,<span class="st">"Site Num"</span>,<span class="st">"Address"</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Mean</th>
      <th>NO2 1st Max Value</th>
      <th>NO2 1st Max Hour</th>
      <th>NO2 AQI</th>
      <th>...</th>
      <th>O3 1st Max Hour</th>
      <th>O3 AQI</th>
      <th>SO2 Mean</th>
      <th>SO2 1st Max Value</th>
      <th>SO2 1st Max Hour</th>
      <th>SO2 AQI</th>
      <th>CO Mean</th>
      <th>CO 1st Max Value</th>
      <th>CO 1st Max Hour</th>
      <th>CO AQI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>13</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>19.041667</td>
      <td>49.0</td>
      <td>19</td>
      <td>46</td>
      <td>...</td>
      <td>10</td>
      <td>34</td>
      <td>3.000000</td>
      <td>9.0</td>
      <td>21</td>
      <td>13.0</td>
      <td>1.145833</td>
      <td>4.200</td>
      <td>21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>13</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>19.041667</td>
      <td>49.0</td>
      <td>19</td>
      <td>46</td>
      <td>...</td>
      <td>10</td>
      <td>34</td>
      <td>3.000000</td>
      <td>9.0</td>
      <td>21</td>
      <td>13.0</td>
      <td>0.878947</td>
      <td>2.200</td>
      <td>23</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>13</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>19.041667</td>
      <td>49.0</td>
      <td>19</td>
      <td>46</td>
      <td>...</td>
      <td>10</td>
      <td>34</td>
      <td>2.975000</td>
      <td>6.6</td>
      <td>23</td>
      <td>NaN</td>
      <td>1.145833</td>
      <td>4.200</td>
      <td>21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>13</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-01</td>
      <td>19.041667</td>
      <td>49.0</td>
      <td>19</td>
      <td>46</td>
      <td>...</td>
      <td>10</td>
      <td>34</td>
      <td>2.975000</td>
      <td>6.6</td>
      <td>23</td>
      <td>NaN</td>
      <td>0.878947</td>
      <td>2.200</td>
      <td>23</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>13</td>
      <td>Arizona</td>
      <td>Maricopa</td>
      <td>Phoenix</td>
      <td>2000-01-02</td>
      <td>22.958333</td>
      <td>36.0</td>
      <td>19</td>
      <td>34</td>
      <td>...</td>
      <td>10</td>
      <td>27</td>
      <td>1.958333</td>
      <td>3.0</td>
      <td>22</td>
      <td>4.0</td>
      <td>0.850000</td>
      <td>1.600</td>
      <td>23</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24599</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016-03-30</td>
      <td>1.083333</td>
      <td>1.6</td>
      <td>9</td>
      <td>1</td>
      <td>...</td>
      <td>18</td>
      <td>44</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>0.091667</td>
      <td>0.100</td>
      <td>2</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24600</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016-03-31</td>
      <td>0.939130</td>
      <td>1.3</td>
      <td>5</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>44</td>
      <td>-0.022727</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.067714</td>
      <td>0.127</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24601</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016-03-31</td>
      <td>0.939130</td>
      <td>1.3</td>
      <td>5</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>44</td>
      <td>-0.022727</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.100000</td>
      <td>0.100</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24602</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016-03-31</td>
      <td>0.939130</td>
      <td>1.3</td>
      <td>5</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>44</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>5</td>
      <td>NaN</td>
      <td>0.067714</td>
      <td>0.127</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24603</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016-03-31</td>
      <td>0.939130</td>
      <td>1.3</td>
      <td>5</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>44</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>5</td>
      <td>NaN</td>
      <td>0.100000</td>
      <td>0.100</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>1746661 rows Ã— 22 columns</p>
</div>
</div>
</div>
<p>have dates only be years so we can average</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>EPA[<span class="st">"Date Local"</span>] <span class="op">=</span> EPA[<span class="st">"Date Local"</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>EPA.head()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> EPA.columns[<span class="dv">6</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="averaging-data" class="level2">
<h2 class="anchored" data-anchor-id="averaging-data">Averaging data</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>EPA_grouped <span class="op">=</span> EPA.groupby([<span class="st">"State Code"</span>,<span class="st">"County Code"</span>,<span class="st">"State"</span>,<span class="st">"County"</span>,<span class="st">"City"</span>,<span class="st">"Date Local"</span>])[cols].mean().reset_index()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>EPA_grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/vk/xj75_42s2sg_qkc3_dxpnbww0000gn/T/ipykernel_58672/119620270.py:1: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  EPA_grouped = EPA.groupby(["State Code","County Code","State","County","City","Date Local"])[cols].mean().reset_index()</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Mean</th>
      <th>NO2 1st Max Value</th>
      <th>NO2 1st Max Hour</th>
      <th>NO2 AQI</th>
      <th>...</th>
      <th>O3 1st Max Hour</th>
      <th>O3 AQI</th>
      <th>SO2 Mean</th>
      <th>SO2 1st Max Value</th>
      <th>SO2 1st Max Hour</th>
      <th>SO2 AQI</th>
      <th>CO Mean</th>
      <th>CO 1st Max Value</th>
      <th>CO 1st Max Hour</th>
      <th>CO AQI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2013</td>
      <td>12.065635</td>
      <td>23.141935</td>
      <td>13.838710</td>
      <td>21.387097</td>
      <td>...</td>
      <td>10.225806</td>
      <td>18.903226</td>
      <td>0.750311</td>
      <td>3.609677</td>
      <td>11.290323</td>
      <td>6.580645</td>
      <td>0.211007</td>
      <td>0.440323</td>
      <td>11.387097</td>
      <td>4.129032</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2014</td>
      <td>9.411746</td>
      <td>23.215423</td>
      <td>12.451078</td>
      <td>21.495854</td>
      <td>...</td>
      <td>9.278607</td>
      <td>36.983416</td>
      <td>1.186517</td>
      <td>4.746932</td>
      <td>10.845771</td>
      <td>7.956954</td>
      <td>0.205921</td>
      <td>0.389561</td>
      <td>9.400498</td>
      <td>3.711443</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2015</td>
      <td>9.078580</td>
      <td>21.699000</td>
      <td>13.980000</td>
      <td>20.026667</td>
      <td>...</td>
      <td>9.130000</td>
      <td>37.343333</td>
      <td>1.009429</td>
      <td>4.243500</td>
      <td>10.326667</td>
      <td>6.950000</td>
      <td>0.221027</td>
      <td>0.419567</td>
      <td>8.971667</td>
      <td>3.933333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2016</td>
      <td>9.524873</td>
      <td>24.991946</td>
      <td>12.791946</td>
      <td>23.093960</td>
      <td>...</td>
      <td>9.456376</td>
      <td>39.295302</td>
      <td>0.835118</td>
      <td>3.286913</td>
      <td>11.328859</td>
      <td>5.275168</td>
      <td>0.209514</td>
      <td>0.412081</td>
      <td>10.090604</td>
      <td>3.906040</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>90</td>
      <td>Alaska</td>
      <td>Fairbanks North Star</td>
      <td>Fairbanks</td>
      <td>2014</td>
      <td>11.658510</td>
      <td>22.701676</td>
      <td>12.189944</td>
      <td>21.167598</td>
      <td>...</td>
      <td>10.268156</td>
      <td>15.206704</td>
      <td>5.951531</td>
      <td>9.356704</td>
      <td>9.810056</td>
      <td>14.000000</td>
      <td>0.455444</td>
      <td>0.715922</td>
      <td>10.790503</td>
      <td>6.983240</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1420</th>
      <td>80</td>
      <td>2</td>
      <td>Country Of Mexico</td>
      <td>BAJA CALIFORNIA NORTE</td>
      <td>Tijuana</td>
      <td>2007</td>
      <td>22.243376</td>
      <td>41.343348</td>
      <td>13.184549</td>
      <td>39.274678</td>
      <td>...</td>
      <td>9.326180</td>
      <td>25.605150</td>
      <td>1.796731</td>
      <td>4.914592</td>
      <td>9.040773</td>
      <td>8.330472</td>
      <td>0.878303</td>
      <td>1.871674</td>
      <td>10.802575</td>
      <td>16.456897</td>
    </tr>
    <tr>
      <th>1421</th>
      <td>80</td>
      <td>2</td>
      <td>Country Of Mexico</td>
      <td>BAJA CALIFORNIA NORTE</td>
      <td>Tijuana</td>
      <td>2008</td>
      <td>23.213464</td>
      <td>45.042500</td>
      <td>13.875000</td>
      <td>42.112500</td>
      <td>...</td>
      <td>9.737500</td>
      <td>25.850000</td>
      <td>0.788606</td>
      <td>2.275625</td>
      <td>6.468750</td>
      <td>3.500000</td>
      <td>1.002565</td>
      <td>2.098813</td>
      <td>9.725000</td>
      <td>18.275000</td>
    </tr>
    <tr>
      <th>1422</th>
      <td>80</td>
      <td>2</td>
      <td>Country Of Mexico</td>
      <td>BAJA CALIFORNIA NORTE</td>
      <td>Tijuana</td>
      <td>2009</td>
      <td>27.828050</td>
      <td>52.160000</td>
      <td>13.500000</td>
      <td>49.900000</td>
      <td>...</td>
      <td>9.900000</td>
      <td>32.400000</td>
      <td>0.906508</td>
      <td>2.615000</td>
      <td>8.750000</td>
      <td>4.000000</td>
      <td>1.077607</td>
      <td>2.827500</td>
      <td>11.700000</td>
      <td>23.300000</td>
    </tr>
    <tr>
      <th>1423</th>
      <td>80</td>
      <td>2</td>
      <td>Country Of Mexico</td>
      <td>BAJA CALIFORNIA NORTE</td>
      <td>Tijuana</td>
      <td>2010</td>
      <td>15.072589</td>
      <td>27.384328</td>
      <td>12.298507</td>
      <td>25.477612</td>
      <td>...</td>
      <td>9.694030</td>
      <td>28.402985</td>
      <td>0.742348</td>
      <td>1.664552</td>
      <td>10.690299</td>
      <td>2.186567</td>
      <td>0.823747</td>
      <td>1.215821</td>
      <td>10.578358</td>
      <td>11.820896</td>
    </tr>
    <tr>
      <th>1424</th>
      <td>80</td>
      <td>2</td>
      <td>Country Of Mexico</td>
      <td>BAJA CALIFORNIA NORTE</td>
      <td>Tijuana</td>
      <td>2011</td>
      <td>21.924678</td>
      <td>40.413896</td>
      <td>12.831063</td>
      <td>37.422343</td>
      <td>...</td>
      <td>10.724796</td>
      <td>21.901907</td>
      <td>3.926371</td>
      <td>5.935422</td>
      <td>12.861035</td>
      <td>8.951087</td>
      <td>0.846088</td>
      <td>1.817589</td>
      <td>10.385559</td>
      <td>15.653951</td>
    </tr>
  </tbody>
</table>
<p>1425 rows Ã— 22 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="county-data" class="level1">
<h1>County data</h1>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>county_income <span class="op">=</span> pd.read_excel(<span class="st">"est20all.xls"</span>, header <span class="op">=</span><span class="dv">3</span>, usecols<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">22</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>county_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State FIPS Code</th>
      <th>County FIPS Code</th>
      <th>Postal Code</th>
      <th>Name</th>
      <th>Median Household Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>US</td>
      <td>United States</td>
      <td>67340</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>AL</td>
      <td>Alabama</td>
      <td>53958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>AL</td>
      <td>Autauga County</td>
      <td>67565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>AL</td>
      <td>Baldwin County</td>
      <td>71135</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>AL</td>
      <td>Barbour County</td>
      <td>38866</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3190</th>
      <td>56</td>
      <td>37</td>
      <td>WY</td>
      <td>Sweetwater County</td>
      <td>70583</td>
    </tr>
    <tr>
      <th>3191</th>
      <td>56</td>
      <td>39</td>
      <td>WY</td>
      <td>Teton County</td>
      <td>92488</td>
    </tr>
    <tr>
      <th>3192</th>
      <td>56</td>
      <td>41</td>
      <td>WY</td>
      <td>Uinta County</td>
      <td>71246</td>
    </tr>
    <tr>
      <th>3193</th>
      <td>56</td>
      <td>43</td>
      <td>WY</td>
      <td>Washakie County</td>
      <td>58532</td>
    </tr>
    <tr>
      <th>3194</th>
      <td>56</td>
      <td>45</td>
      <td>WY</td>
      <td>Weston County</td>
      <td>58901</td>
    </tr>
  </tbody>
</table>
<p>3195 rows Ã— 5 columns</p>
</div>
</div>
</div>
<section id="merging-data" class="level2">
<h2 class="anchored" data-anchor-id="merging-data">Merging data</h2>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>county_income <span class="op">=</span> county_income.rename(columns<span class="op">=</span>{<span class="st">"State FIPS Code"</span>:<span class="st">"State Code"</span>,<span class="st">"County FIPS Code"</span>:<span class="st">"County Code"</span>})</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>county_income.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>Postal Code</th>
      <th>Name</th>
      <th>Median Household Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>US</td>
      <td>United States</td>
      <td>67340</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>AL</td>
      <td>Alabama</td>
      <td>53958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>AL</td>
      <td>Autauga County</td>
      <td>67565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>AL</td>
      <td>Baldwin County</td>
      <td>71135</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>AL</td>
      <td>Barbour County</td>
      <td>38866</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>EPA_grouped <span class="op">=</span> pd.merge(EPA_grouped, county_income[[<span class="st">"State Code"</span>,<span class="st">"County Code"</span>,<span class="st">"Median Household Income"</span>]],on <span class="op">=</span> [<span class="st">"State Code"</span>,<span class="st">"County Code"</span>], how <span class="op">=</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>EPA_grouped.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Mean</th>
      <th>NO2 1st Max Value</th>
      <th>NO2 1st Max Hour</th>
      <th>NO2 AQI</th>
      <th>...</th>
      <th>O3 AQI</th>
      <th>SO2 Mean</th>
      <th>SO2 1st Max Value</th>
      <th>SO2 1st Max Hour</th>
      <th>SO2 AQI</th>
      <th>CO Mean</th>
      <th>CO 1st Max Value</th>
      <th>CO 1st Max Hour</th>
      <th>CO AQI</th>
      <th>Median Household Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2013</td>
      <td>12.065635</td>
      <td>23.141935</td>
      <td>13.838710</td>
      <td>21.387097</td>
      <td>...</td>
      <td>18.903226</td>
      <td>0.750311</td>
      <td>3.609677</td>
      <td>11.290323</td>
      <td>6.580645</td>
      <td>0.211007</td>
      <td>0.440323</td>
      <td>11.387097</td>
      <td>4.129032</td>
      <td>57802</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2014</td>
      <td>9.411746</td>
      <td>23.215423</td>
      <td>12.451078</td>
      <td>21.495854</td>
      <td>...</td>
      <td>36.983416</td>
      <td>1.186517</td>
      <td>4.746932</td>
      <td>10.845771</td>
      <td>7.956954</td>
      <td>0.205921</td>
      <td>0.389561</td>
      <td>9.400498</td>
      <td>3.711443</td>
      <td>57802</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2015</td>
      <td>9.078580</td>
      <td>21.699000</td>
      <td>13.980000</td>
      <td>20.026667</td>
      <td>...</td>
      <td>37.343333</td>
      <td>1.009429</td>
      <td>4.243500</td>
      <td>10.326667</td>
      <td>6.950000</td>
      <td>0.221027</td>
      <td>0.419567</td>
      <td>8.971667</td>
      <td>3.933333</td>
      <td>57802</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2016</td>
      <td>9.524873</td>
      <td>24.991946</td>
      <td>12.791946</td>
      <td>23.093960</td>
      <td>...</td>
      <td>39.295302</td>
      <td>0.835118</td>
      <td>3.286913</td>
      <td>11.328859</td>
      <td>5.275168</td>
      <td>0.209514</td>
      <td>0.412081</td>
      <td>10.090604</td>
      <td>3.906040</td>
      <td>57802</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>90</td>
      <td>Alaska</td>
      <td>Fairbanks North Star</td>
      <td>Fairbanks</td>
      <td>2014</td>
      <td>11.658510</td>
      <td>22.701676</td>
      <td>12.189944</td>
      <td>21.167598</td>
      <td>...</td>
      <td>15.206704</td>
      <td>5.951531</td>
      <td>9.356704</td>
      <td>9.810056</td>
      <td>14.000000</td>
      <td>0.455444</td>
      <td>0.715922</td>
      <td>10.790503</td>
      <td>6.983240</td>
      <td>76650</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 23 columns</p>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>county_income.loc[(county_income[<span class="st">"State Code"</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">&amp;</span> (county_income[<span class="st">"County Code"</span>] <span class="op">==</span> <span class="dv">73</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>Postal Code</th>
      <th>Name</th>
      <th>Median Household Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>38</th>
      <td>1</td>
      <td>73</td>
      <td>AL</td>
      <td>Jefferson County</td>
      <td>57802</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>they match!</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>EPA_grouped[<span class="st">"AQI Total"</span>] <span class="op">=</span> EPA_grouped[<span class="st">"CO AQI"</span>] <span class="op">+</span> EPA_grouped[<span class="st">"NO2 AQI"</span>] <span class="op">+</span> EPA_grouped[<span class="st">"O3 AQI"</span>] <span class="op">+</span> EPA_grouped[<span class="st">"SO2 AQI"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>EPA_grouped.to_csv(<span class="st">"EPA_income.csv"</span>,index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="race-distribution-data" class="level3">
<h3 class="anchored" data-anchor-id="race-distribution-data">Race distribution data</h3>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>race_data <span class="op">=</span> pd.read_csv(<span class="st">"cc-est2021-all.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>race_data.head()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>race_data<span class="op">=</span>race_data.drop(<span class="st">"SUMLEV"</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>race_data.drop(race_data.columns[<span class="dv">20</span>:],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>STNAME</th>
      <th>CTYNAME</th>
      <th>YEAR</th>
      <th>AGEGRP</th>
      <th>TOT_POP</th>
      <th>TOT_MALE</th>
      <th>TOT_FEMALE</th>
      <th>WA_MALE</th>
      <th>WA_FEMALE</th>
      <th>BA_MALE</th>
      <th>BA_FEMALE</th>
      <th>IA_MALE</th>
      <th>IA_FEMALE</th>
      <th>AA_MALE</th>
      <th>AA_FEMALE</th>
      <th>NA_MALE</th>
      <th>NA_FEMALE</th>
      <th>TOM_MALE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>0</td>
      <td>58805</td>
      <td>28703</td>
      <td>30102</td>
      <td>21985</td>
      <td>22619</td>
      <td>5688</td>
      <td>6378</td>
      <td>133</td>
      <td>148</td>
      <td>297</td>
      <td>390</td>
      <td>35</td>
      <td>30</td>
      <td>565</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>1</td>
      <td>3486</td>
      <td>1812</td>
      <td>1674</td>
      <td>1296</td>
      <td>1171</td>
      <td>386</td>
      <td>391</td>
      <td>4</td>
      <td>4</td>
      <td>31</td>
      <td>23</td>
      <td>3</td>
      <td>3</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>2</td>
      <td>3657</td>
      <td>1870</td>
      <td>1787</td>
      <td>1344</td>
      <td>1270</td>
      <td>410</td>
      <td>387</td>
      <td>13</td>
      <td>10</td>
      <td>20</td>
      <td>29</td>
      <td>0</td>
      <td>4</td>
      <td>83</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>3</td>
      <td>4178</td>
      <td>2144</td>
      <td>2034</td>
      <td>1535</td>
      <td>1455</td>
      <td>502</td>
      <td>463</td>
      <td>7</td>
      <td>12</td>
      <td>17</td>
      <td>26</td>
      <td>2</td>
      <td>2</td>
      <td>81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>4</td>
      <td>3862</td>
      <td>1948</td>
      <td>1914</td>
      <td>1405</td>
      <td>1405</td>
      <td>460</td>
      <td>423</td>
      <td>6</td>
      <td>2</td>
      <td>21</td>
      <td>24</td>
      <td>4</td>
      <td>7</td>
      <td>52</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>179146</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>3</td>
      <td>14</td>
      <td>583</td>
      <td>316</td>
      <td>267</td>
      <td>285</td>
      <td>240</td>
      <td>3</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>18</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>179147</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>3</td>
      <td>15</td>
      <td>373</td>
      <td>202</td>
      <td>171</td>
      <td>199</td>
      <td>168</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>179148</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>3</td>
      <td>16</td>
      <td>231</td>
      <td>111</td>
      <td>120</td>
      <td>107</td>
      <td>116</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>179149</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>3</td>
      <td>17</td>
      <td>152</td>
      <td>59</td>
      <td>93</td>
      <td>56</td>
      <td>92</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>179150</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>3</td>
      <td>18</td>
      <td>184</td>
      <td>68</td>
      <td>116</td>
      <td>66</td>
      <td>114</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>179151 rows Ã— 20 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(race_data.columns)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>race_columns <span class="op">=</span> race_data.columns</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>race_col_togroup <span class="op">=</span> race_columns[<span class="dv">6</span>:<span class="dv">20</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>race_data<span class="op">=</span>race_data.rename(columns<span class="op">=</span>{<span class="st">"STATE"</span>: <span class="st">"State Code"</span>,<span class="st">"COUNTY"</span>:<span class="st">"County Code"</span>,<span class="st">"STNAME"</span>:<span class="st">"State"</span>,<span class="st">"CTYNAME"</span>:<span class="st">"County"</span>})</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>race_data.head()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(race_col_togroup)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>race_grouped <span class="op">=</span> race_data.groupby([<span class="st">"State Code"</span>,<span class="st">"County Code"</span>,<span class="st">"State"</span>,<span class="st">"County"</span>])[race_col_togroup].<span class="bu">sum</span>().reset_index()</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>race_grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['STATE', 'COUNTY', 'STNAME', 'CTYNAME', 'YEAR', 'AGEGRP', 'TOT_POP',
       'TOT_MALE', 'TOT_FEMALE', 'WA_MALE', 'WA_FEMALE', 'BA_MALE',
       'BA_FEMALE', 'IA_MALE', 'IA_FEMALE', 'AA_MALE', 'AA_FEMALE', 'NA_MALE',
       'NA_FEMALE', 'TOM_MALE', 'TOM_FEMALE', 'WAC_MALE', 'WAC_FEMALE',
       'BAC_MALE', 'BAC_FEMALE', 'IAC_MALE', 'IAC_FEMALE', 'AAC_MALE',
       'AAC_FEMALE', 'NAC_MALE', 'NAC_FEMALE', 'NH_MALE', 'NH_FEMALE',
       'NHWA_MALE', 'NHWA_FEMALE', 'NHBA_MALE', 'NHBA_FEMALE', 'NHIA_MALE',
       'NHIA_FEMALE', 'NHAA_MALE', 'NHAA_FEMALE', 'NHNA_MALE', 'NHNA_FEMALE',
       'NHTOM_MALE', 'NHTOM_FEMALE', 'NHWAC_MALE', 'NHWAC_FEMALE',
       'NHBAC_MALE', 'NHBAC_FEMALE', 'NHIAC_MALE', 'NHIAC_FEMALE',
       'NHAAC_MALE', 'NHAAC_FEMALE', 'NHNAC_MALE', 'NHNAC_FEMALE', 'H_MALE',
       'H_FEMALE', 'HWA_MALE', 'HWA_FEMALE', 'HBA_MALE', 'HBA_FEMALE',
       'HIA_MALE', 'HIA_FEMALE', 'HAA_MALE', 'HAA_FEMALE', 'HNA_MALE',
       'HNA_FEMALE', 'HTOM_MALE', 'HTOM_FEMALE', 'HWAC_MALE', 'HWAC_FEMALE',
       'HBAC_MALE', 'HBAC_FEMALE', 'HIAC_MALE', 'HIAC_FEMALE', 'HAAC_MALE',
       'HAAC_FEMALE', 'HNAC_MALE', 'HNAC_FEMALE'],
      dtype='object')
Index(['TOT_POP', 'TOT_MALE', 'TOT_FEMALE', 'WA_MALE', 'WA_FEMALE', 'BA_MALE',
       'BA_FEMALE', 'IA_MALE', 'IA_FEMALE', 'AA_MALE', 'AA_FEMALE', 'NA_MALE',
       'NA_FEMALE', 'TOM_MALE'],
      dtype='object')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>TOT_POP</th>
      <th>TOT_MALE</th>
      <th>TOT_FEMALE</th>
      <th>WA_MALE</th>
      <th>WA_FEMALE</th>
      <th>BA_MALE</th>
      <th>BA_FEMALE</th>
      <th>IA_MALE</th>
      <th>IA_FEMALE</th>
      <th>AA_MALE</th>
      <th>AA_FEMALE</th>
      <th>NA_MALE</th>
      <th>NA_FEMALE</th>
      <th>TOM_MALE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>353554</td>
      <td>172340</td>
      <td>181214</td>
      <td>131610</td>
      <td>135642</td>
      <td>34394</td>
      <td>38860</td>
      <td>800</td>
      <td>866</td>
      <td>1818</td>
      <td>2358</td>
      <td>214</td>
      <td>188</td>
      <td>3504</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>1408402</td>
      <td>686030</td>
      <td>722372</td>
      <td>600844</td>
      <td>630364</td>
      <td>59020</td>
      <td>62668</td>
      <td>5822</td>
      <td>5346</td>
      <td>6304</td>
      <td>9282</td>
      <td>436</td>
      <td>532</td>
      <td>13604</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>150734</td>
      <td>80156</td>
      <td>70578</td>
      <td>39290</td>
      <td>34662</td>
      <td>38542</td>
      <td>33982</td>
      <td>654</td>
      <td>424</td>
      <td>306</td>
      <td>384</td>
      <td>216</td>
      <td>124</td>
      <td>1148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>7</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>133986</td>
      <td>71932</td>
      <td>62054</td>
      <td>52556</td>
      <td>49844</td>
      <td>17804</td>
      <td>10762</td>
      <td>378</td>
      <td>280</td>
      <td>156</td>
      <td>196</td>
      <td>138</td>
      <td>34</td>
      <td>900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>9</td>
      <td>Alabama</td>
      <td>Blount County</td>
      <td>354512</td>
      <td>176452</td>
      <td>178060</td>
      <td>168618</td>
      <td>170410</td>
      <td>3336</td>
      <td>2936</td>
      <td>1226</td>
      <td>1086</td>
      <td>708</td>
      <td>660</td>
      <td>266</td>
      <td>158</td>
      <td>2298</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3138</th>
      <td>56</td>
      <td>37</td>
      <td>Wyoming</td>
      <td>Sweetwater County</td>
      <td>252088</td>
      <td>130802</td>
      <td>121286</td>
      <td>122786</td>
      <td>113772</td>
      <td>1938</td>
      <td>1444</td>
      <td>1978</td>
      <td>1772</td>
      <td>1108</td>
      <td>1418</td>
      <td>200</td>
      <td>182</td>
      <td>2792</td>
    </tr>
    <tr>
      <th>3139</th>
      <td>56</td>
      <td>39</td>
      <td>Wyoming</td>
      <td>Teton County</td>
      <td>140506</td>
      <td>73334</td>
      <td>67172</td>
      <td>69618</td>
      <td>63588</td>
      <td>680</td>
      <td>462</td>
      <td>736</td>
      <td>668</td>
      <td>944</td>
      <td>1250</td>
      <td>116</td>
      <td>104</td>
      <td>1240</td>
    </tr>
    <tr>
      <th>3140</th>
      <td>56</td>
      <td>41</td>
      <td>Wyoming</td>
      <td>Uinta County</td>
      <td>123052</td>
      <td>62712</td>
      <td>60340</td>
      <td>59964</td>
      <td>57564</td>
      <td>420</td>
      <td>362</td>
      <td>890</td>
      <td>942</td>
      <td>246</td>
      <td>368</td>
      <td>90</td>
      <td>80</td>
      <td>1102</td>
    </tr>
    <tr>
      <th>3141</th>
      <td>56</td>
      <td>43</td>
      <td>Wyoming</td>
      <td>Washakie County</td>
      <td>46096</td>
      <td>23676</td>
      <td>22420</td>
      <td>22434</td>
      <td>21210</td>
      <td>150</td>
      <td>92</td>
      <td>370</td>
      <td>416</td>
      <td>164</td>
      <td>232</td>
      <td>20</td>
      <td>12</td>
      <td>538</td>
    </tr>
    <tr>
      <th>3142</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>40784</td>
      <td>21642</td>
      <td>19142</td>
      <td>20338</td>
      <td>17850</td>
      <td>198</td>
      <td>86</td>
      <td>434</td>
      <td>332</td>
      <td>184</td>
      <td>382</td>
      <td>6</td>
      <td>0</td>
      <td>482</td>
    </tr>
  </tbody>
</table>
<p>3143 rows Ã— 18 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>percentage_col<span class="op">=</span> race_col_togroup[<span class="dv">1</span>:]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>race_grouped[percentage_col] <span class="op">=</span> race_grouped[percentage_col].div(race_grouped[<span class="st">"TOT_POP"</span>],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>race_grouped <span class="op">=</span> race_grouped.rename(columns<span class="op">=</span>{<span class="st">"TOT_POP"</span>:<span class="st">"Total Pop"</span>,<span class="st">"TOT_MALE"</span>:<span class="st">"Total Male %"</span>, <span class="st">"TOT_FEMALE"</span>:<span class="st">"Total Female %"</span>, <span class="st">"WA_MALE"</span>: <span class="st">"White Alone (M) %"</span>,<span class="st">"WA_FEMALE"</span>:<span class="st">"White Alone (F) %"</span>,<span class="st">"BA_MALE"</span>:<span class="st">"Black Alone (M) %"</span>,<span class="st">"BA_FEMALE"</span>:<span class="st">"Black Alone (F) %"</span>, <span class="st">"IA_MALE"</span>:<span class="st">"Am Indian+AK Native Alone (M) %"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"IA_FEMALE"</span>:<span class="st">"Am Indian+AK Native Alone (F) %"</span>,<span class="st">"AA_MALE"</span>:<span class="st">"Asian Alone (M) %"</span>,<span class="st">"AA_FEMALE"</span>:<span class="st">"Asian Alone (F) %"</span>, <span class="st">"NA_MALE"</span>: <span class="st">"Nat. HI and PI (M) %"</span>,<span class="st">"NA_FEMALE"</span>: <span class="st">"Nat. HI and PI (F) %"</span>})</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>race_grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>Total Pop</th>
      <th>Total Male %</th>
      <th>Total Female %</th>
      <th>White Alone (M) %</th>
      <th>White Alone (F) %</th>
      <th>Black Alone (M) %</th>
      <th>Black Alone (F) %</th>
      <th>Am Indian+AK Native Alone (M) %</th>
      <th>Am Indian+AK Native Alone (F) %</th>
      <th>Asian Alone (M) %</th>
      <th>Asian Alone (F) %</th>
      <th>Nat. HI and PI (M) %</th>
      <th>Nat. HI and PI (F) %</th>
      <th>TOM_MALE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>353554</td>
      <td>0.487450</td>
      <td>0.512550</td>
      <td>0.372249</td>
      <td>0.383653</td>
      <td>0.097281</td>
      <td>0.109912</td>
      <td>0.002263</td>
      <td>0.002449</td>
      <td>0.005142</td>
      <td>0.006669</td>
      <td>0.000605</td>
      <td>0.000532</td>
      <td>0.009911</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>1408402</td>
      <td>0.487098</td>
      <td>0.512902</td>
      <td>0.426614</td>
      <td>0.447574</td>
      <td>0.041906</td>
      <td>0.044496</td>
      <td>0.004134</td>
      <td>0.003796</td>
      <td>0.004476</td>
      <td>0.006590</td>
      <td>0.000310</td>
      <td>0.000378</td>
      <td>0.009659</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>150734</td>
      <td>0.531771</td>
      <td>0.468229</td>
      <td>0.260658</td>
      <td>0.229955</td>
      <td>0.255695</td>
      <td>0.225443</td>
      <td>0.004339</td>
      <td>0.002813</td>
      <td>0.002030</td>
      <td>0.002548</td>
      <td>0.001433</td>
      <td>0.000823</td>
      <td>0.007616</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>7</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>133986</td>
      <td>0.536862</td>
      <td>0.463138</td>
      <td>0.392250</td>
      <td>0.372009</td>
      <td>0.132880</td>
      <td>0.080322</td>
      <td>0.002821</td>
      <td>0.002090</td>
      <td>0.001164</td>
      <td>0.001463</td>
      <td>0.001030</td>
      <td>0.000254</td>
      <td>0.006717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>9</td>
      <td>Alabama</td>
      <td>Blount County</td>
      <td>354512</td>
      <td>0.497732</td>
      <td>0.502268</td>
      <td>0.475634</td>
      <td>0.480689</td>
      <td>0.009410</td>
      <td>0.008282</td>
      <td>0.003458</td>
      <td>0.003063</td>
      <td>0.001997</td>
      <td>0.001862</td>
      <td>0.000750</td>
      <td>0.000446</td>
      <td>0.006482</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3138</th>
      <td>56</td>
      <td>37</td>
      <td>Wyoming</td>
      <td>Sweetwater County</td>
      <td>252088</td>
      <td>0.518874</td>
      <td>0.481126</td>
      <td>0.487076</td>
      <td>0.451319</td>
      <td>0.007688</td>
      <td>0.005728</td>
      <td>0.007846</td>
      <td>0.007029</td>
      <td>0.004395</td>
      <td>0.005625</td>
      <td>0.000793</td>
      <td>0.000722</td>
      <td>0.011075</td>
    </tr>
    <tr>
      <th>3139</th>
      <td>56</td>
      <td>39</td>
      <td>Wyoming</td>
      <td>Teton County</td>
      <td>140506</td>
      <td>0.521928</td>
      <td>0.478072</td>
      <td>0.495481</td>
      <td>0.452564</td>
      <td>0.004840</td>
      <td>0.003288</td>
      <td>0.005238</td>
      <td>0.004754</td>
      <td>0.006719</td>
      <td>0.008896</td>
      <td>0.000826</td>
      <td>0.000740</td>
      <td>0.008825</td>
    </tr>
    <tr>
      <th>3140</th>
      <td>56</td>
      <td>41</td>
      <td>Wyoming</td>
      <td>Uinta County</td>
      <td>123052</td>
      <td>0.509638</td>
      <td>0.490362</td>
      <td>0.487306</td>
      <td>0.467802</td>
      <td>0.003413</td>
      <td>0.002942</td>
      <td>0.007233</td>
      <td>0.007655</td>
      <td>0.001999</td>
      <td>0.002991</td>
      <td>0.000731</td>
      <td>0.000650</td>
      <td>0.008956</td>
    </tr>
    <tr>
      <th>3141</th>
      <td>56</td>
      <td>43</td>
      <td>Wyoming</td>
      <td>Washakie County</td>
      <td>46096</td>
      <td>0.513624</td>
      <td>0.486376</td>
      <td>0.486680</td>
      <td>0.460127</td>
      <td>0.003254</td>
      <td>0.001996</td>
      <td>0.008027</td>
      <td>0.009025</td>
      <td>0.003558</td>
      <td>0.005033</td>
      <td>0.000434</td>
      <td>0.000260</td>
      <td>0.011671</td>
    </tr>
    <tr>
      <th>3142</th>
      <td>56</td>
      <td>45</td>
      <td>Wyoming</td>
      <td>Weston County</td>
      <td>40784</td>
      <td>0.530649</td>
      <td>0.469351</td>
      <td>0.498676</td>
      <td>0.437672</td>
      <td>0.004855</td>
      <td>0.002109</td>
      <td>0.010641</td>
      <td>0.008140</td>
      <td>0.004512</td>
      <td>0.009366</td>
      <td>0.000147</td>
      <td>0.000000</td>
      <td>0.011818</td>
    </tr>
  </tbody>
</table>
<p>3143 rows Ã— 18 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pollution_income <span class="op">=</span> pd.read_csv(<span class="st">"EPA_income.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pollution_income.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Mean</th>
      <th>NO2 1st Max Value</th>
      <th>NO2 1st Max Hour</th>
      <th>NO2 AQI</th>
      <th>...</th>
      <th>SO2 Mean</th>
      <th>SO2 1st Max Value</th>
      <th>SO2 1st Max Hour</th>
      <th>SO2 AQI</th>
      <th>CO Mean</th>
      <th>CO 1st Max Value</th>
      <th>CO 1st Max Hour</th>
      <th>CO AQI</th>
      <th>Median Household Income</th>
      <th>AQI Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2013</td>
      <td>12.065635</td>
      <td>23.141935</td>
      <td>13.838710</td>
      <td>21.387097</td>
      <td>...</td>
      <td>0.750311</td>
      <td>3.609677</td>
      <td>11.290323</td>
      <td>6.580645</td>
      <td>0.211007</td>
      <td>0.440323</td>
      <td>11.387097</td>
      <td>4.129032</td>
      <td>57802.0</td>
      <td>51.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2014</td>
      <td>9.411746</td>
      <td>23.215423</td>
      <td>12.451078</td>
      <td>21.495854</td>
      <td>...</td>
      <td>1.186517</td>
      <td>4.746932</td>
      <td>10.845771</td>
      <td>7.956954</td>
      <td>0.205921</td>
      <td>0.389561</td>
      <td>9.400498</td>
      <td>3.711443</td>
      <td>57802.0</td>
      <td>70.147667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2015</td>
      <td>9.078580</td>
      <td>21.699000</td>
      <td>13.980000</td>
      <td>20.026667</td>
      <td>...</td>
      <td>1.009429</td>
      <td>4.243500</td>
      <td>10.326667</td>
      <td>6.950000</td>
      <td>0.221027</td>
      <td>0.419567</td>
      <td>8.971667</td>
      <td>3.933333</td>
      <td>57802.0</td>
      <td>68.253333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2016</td>
      <td>9.524873</td>
      <td>24.991946</td>
      <td>12.791946</td>
      <td>23.093960</td>
      <td>...</td>
      <td>0.835118</td>
      <td>3.286913</td>
      <td>11.328859</td>
      <td>5.275168</td>
      <td>0.209514</td>
      <td>0.412081</td>
      <td>10.090604</td>
      <td>3.906040</td>
      <td>57802.0</td>
      <td>71.570470</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>90</td>
      <td>Alaska</td>
      <td>Fairbanks North Star</td>
      <td>Fairbanks</td>
      <td>2014</td>
      <td>11.658510</td>
      <td>22.701676</td>
      <td>12.189944</td>
      <td>21.167598</td>
      <td>...</td>
      <td>5.951531</td>
      <td>9.356704</td>
      <td>9.810056</td>
      <td>14.000000</td>
      <td>0.455444</td>
      <td>0.715922</td>
      <td>10.790503</td>
      <td>6.983240</td>
      <td>76650.0</td>
      <td>57.357542</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 24 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pollution_income <span class="op">=</span> pd.merge(pollution_income,race_grouped, on <span class="op">=</span> [<span class="st">"State Code"</span>,<span class="st">"County Code"</span>],how <span class="op">=</span> <span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pollution_income.rename(columns<span class="op">=</span> {<span class="st">"State_x"</span>:<span class="st">"State"</span>,<span class="st">"County_x"</span>:<span class="st">"County"</span>,<span class="st">"State_x"</span>:<span class="st">"State"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State Code</th>
      <th>County Code</th>
      <th>State</th>
      <th>County</th>
      <th>City</th>
      <th>Date Local</th>
      <th>NO2 Mean</th>
      <th>NO2 1st Max Value</th>
      <th>NO2 1st Max Hour</th>
      <th>NO2 AQI</th>
      <th>...</th>
      <th>White Alone (F) %</th>
      <th>Black Alone (M) %</th>
      <th>Black Alone (F) %</th>
      <th>Am Indian+AK Native Alone (M) %</th>
      <th>Am Indian+AK Native Alone (F) %</th>
      <th>Asian Alone (M) %</th>
      <th>Asian Alone (F) %</th>
      <th>Nat. HI and PI (M) %</th>
      <th>Nat. HI and PI (F) %</th>
      <th>TOM_MALE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2013</td>
      <td>12.065635</td>
      <td>23.141935</td>
      <td>13.838710</td>
      <td>21.387097</td>
      <td>...</td>
      <td>0.269975</td>
      <td>0.200176</td>
      <td>0.236806</td>
      <td>0.001385</td>
      <td>0.001460</td>
      <td>0.008714</td>
      <td>0.009611</td>
      <td>0.000263</td>
      <td>0.000263</td>
      <td>0.006665</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2014</td>
      <td>9.411746</td>
      <td>23.215423</td>
      <td>12.451078</td>
      <td>21.495854</td>
      <td>...</td>
      <td>0.269975</td>
      <td>0.200176</td>
      <td>0.236806</td>
      <td>0.001385</td>
      <td>0.001460</td>
      <td>0.008714</td>
      <td>0.009611</td>
      <td>0.000263</td>
      <td>0.000263</td>
      <td>0.006665</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2015</td>
      <td>9.078580</td>
      <td>21.699000</td>
      <td>13.980000</td>
      <td>20.026667</td>
      <td>...</td>
      <td>0.269975</td>
      <td>0.200176</td>
      <td>0.236806</td>
      <td>0.001385</td>
      <td>0.001460</td>
      <td>0.008714</td>
      <td>0.009611</td>
      <td>0.000263</td>
      <td>0.000263</td>
      <td>0.006665</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>73</td>
      <td>Alabama</td>
      <td>Jefferson</td>
      <td>Birmingham</td>
      <td>2016</td>
      <td>9.524873</td>
      <td>24.991946</td>
      <td>12.791946</td>
      <td>23.093960</td>
      <td>...</td>
      <td>0.269975</td>
      <td>0.200176</td>
      <td>0.236806</td>
      <td>0.001385</td>
      <td>0.001460</td>
      <td>0.008714</td>
      <td>0.009611</td>
      <td>0.000263</td>
      <td>0.000263</td>
      <td>0.006665</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>90</td>
      <td>Alaska</td>
      <td>Fairbanks North Star</td>
      <td>Fairbanks</td>
      <td>2014</td>
      <td>11.658510</td>
      <td>22.701676</td>
      <td>12.189944</td>
      <td>21.167598</td>
      <td>...</td>
      <td>0.340295</td>
      <td>0.030384</td>
      <td>0.021819</td>
      <td>0.040767</td>
      <td>0.040826</td>
      <td>0.016030</td>
      <td>0.018165</td>
      <td>0.003043</td>
      <td>0.002855</td>
      <td>0.036701</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1403</th>
      <td>56</td>
      <td>21</td>
      <td>Wyoming</td>
      <td>Laramie</td>
      <td>Not in a city</td>
      <td>2016</td>
      <td>3.425564</td>
      <td>11.320000</td>
      <td>12.444444</td>
      <td>10.288889</td>
      <td>...</td>
      <td>0.450986</td>
      <td>0.015053</td>
      <td>0.009985</td>
      <td>0.006456</td>
      <td>0.006479</td>
      <td>0.006618</td>
      <td>0.006992</td>
      <td>0.000864</td>
      <td>0.000798</td>
      <td>0.016371</td>
    </tr>
    <tr>
      <th>1404</th>
      <td>56</td>
      <td>37</td>
      <td>Wyoming</td>
      <td>Sweetwater</td>
      <td>Not in a city</td>
      <td>2011</td>
      <td>6.035571</td>
      <td>16.616114</td>
      <td>10.218009</td>
      <td>15.635071</td>
      <td>...</td>
      <td>0.451319</td>
      <td>0.007688</td>
      <td>0.005728</td>
      <td>0.007846</td>
      <td>0.007029</td>
      <td>0.004395</td>
      <td>0.005625</td>
      <td>0.000793</td>
      <td>0.000722</td>
      <td>0.011075</td>
    </tr>
    <tr>
      <th>1405</th>
      <td>56</td>
      <td>37</td>
      <td>Wyoming</td>
      <td>Sweetwater</td>
      <td>Not in a city</td>
      <td>2012</td>
      <td>3.997673</td>
      <td>12.655462</td>
      <td>9.187675</td>
      <td>11.935574</td>
      <td>...</td>
      <td>0.451319</td>
      <td>0.007688</td>
      <td>0.005728</td>
      <td>0.007846</td>
      <td>0.007029</td>
      <td>0.004395</td>
      <td>0.005625</td>
      <td>0.000793</td>
      <td>0.000722</td>
      <td>0.011075</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>56</td>
      <td>41</td>
      <td>Wyoming</td>
      <td>Uinta</td>
      <td>Not in a city</td>
      <td>2007</td>
      <td>1.733819</td>
      <td>6.368421</td>
      <td>8.963989</td>
      <td>6.094183</td>
      <td>...</td>
      <td>0.467802</td>
      <td>0.003413</td>
      <td>0.002942</td>
      <td>0.007233</td>
      <td>0.007655</td>
      <td>0.001999</td>
      <td>0.002991</td>
      <td>0.000731</td>
      <td>0.000650</td>
      <td>0.008956</td>
    </tr>
    <tr>
      <th>1407</th>
      <td>56</td>
      <td>41</td>
      <td>Wyoming</td>
      <td>Uinta</td>
      <td>Not in a city</td>
      <td>2008</td>
      <td>2.270178</td>
      <td>7.028939</td>
      <td>9.192926</td>
      <td>6.762058</td>
      <td>...</td>
      <td>0.467802</td>
      <td>0.003413</td>
      <td>0.002942</td>
      <td>0.007233</td>
      <td>0.007655</td>
      <td>0.001999</td>
      <td>0.002991</td>
      <td>0.000731</td>
      <td>0.000650</td>
      <td>0.008956</td>
    </tr>
  </tbody>
</table>
<p>1408 rows Ã— 40 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pollution_income.to_csv(<span class="st">"pollution_income_race.csv"</span>,index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>